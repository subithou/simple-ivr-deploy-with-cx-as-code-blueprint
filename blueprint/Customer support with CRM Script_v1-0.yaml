inboundCall:
  name: Customer support with CRM Script
  division: Home
  startUpRef: "/inboundCall/menus/menu[Main Menu_10]"
  defaultLanguage: en-us
  supportedLanguages:
    en-us:
      defaultLanguageSkill:
        noValue: true
      textToSpeech:
        defaultEngine:
          voice: Jill
  initialGreeting:
    tts: Welcome to Disfruta we are happy to help you.
  settingsActionDefaults:
    playAudioOnSilence:
      timeout:
        lit:
          seconds: 40
    detectSilence:
      timeout:
        lit:
          seconds: 40
    callData:
      processingPrompt:
        noValue: true
    collectInput:
      noEntryTimeout:
        lit:
          seconds: 5
    dialByExtension:
      interDigitTimeout:
        lit:
          seconds: 6
    transferToUser:
      connectTimeout:
        noValue: true
    transferToNumber:
      connectTimeout:
        noValue: true
    transferToGroup:
      connectTimeout:
        noValue: true
    transferToFlowSecure:
      connectTimeout:
        lit:
          seconds: 15
  settingsErrorHandling:
    errorHandling:
      disconnect:
        none: true
    preHandlingAudio:
      tts: Sorry, an error occurred. Please try your call again.
  settingsMenu:
    extensionDialingMaxDelay:
      lit:
        seconds: 1
    listenForExtensionDialing:
      lit: true
    menuSelectionTimeout:
      lit:
        seconds: 10
    repeatCount:
      lit: 3
  settingsPrompts:
    ensureAudioInPrompts: false
    promptMediaToValidate:
      - mediaType: audio
      - mediaType: tts
  settingsSpeechRec:
    completeMatchTimeout:
      lit:
        ms: 100
    incompleteMatchTimeout:
      lit:
        ms: 1500
    maxSpeechLengthTimeout:
      lit:
        seconds: 20
    minConfidenceLevel:
      lit: 50
    asrCompanyDir: none
    asrEnabledOnFlow: true
    suppressRecording: false
  menus:
    - menu:
        name: Main Menu
        refId: Main Menu_10
        audio:
          tts: Press1 to connect support.press 9 to disconnect
        settingsMenu:
          extensionDialingMaxDelay:
            noValue: true
          listenForExtensionDialing:
            noValue: true
          menuSelectionTimeout:
            noValue: true
          repeatCount:
            noValue: true
        settingsSpeechRec:
          completeMatchTimeout:
            noValue: true
          incompleteMatchTimeout:
            noValue: true
          maxSpeechLengthTimeout:
            noValue: true
          minConfidenceLevel:
            noValue: true
        choices:
          - menuDisconnect:
              name: Disconnect
              dtmf: digit_9
              globalDtmf: false
              globalSpeechRecTerms: false
          - menuTask:
              name: Customer Data
              dtmf: digit_1
              globalDtmf: false
              globalSpeechRecTerms: false
              task:
                variables:
                  - stringVariable:
                      name: Task.CustomerEmail
                      initialValue:
                        noValue: true
                      isInput: false
                      isOutput: false
                  - stringVariable:
                      name: Task.CustomerFirstName
                      initialValue:
                        noValue: true
                      isInput: false
                      isOutput: false
                  - stringVariable:
                      name: Task.CustomerInput
                      initialValue:
                        noValue: true
                      isInput: false
                      isOutput: false
                actions:
                  - collectInput:
                      name: Collect Input
                      inputData:
                        var: Task.CustomerInput
                      digits:
                        range:
                          terminatingDtmf: "digit_#"
                          min: 1
                          max: 10
                      interDigitTimeout:
                        noValue: true
                      noEntryTimeout:
                        noValue: true
                      inputAudio:
                        tts: "Please enter your registered phone number along with # key."
                      includeTerminatingDtmfInResultData: false
                      acceptJustStar:
                        lit: false
                      acceptJustPound:
                        lit: false
                      verificationType: individualDigits
                      outputs:
                        success:
                          actions:
                            - callData:
                                name: Call Data Action
                                processingPrompt:
                                  noValue: true
                                timeout:
                                  lit:
                                    minutes: 1
                                category:
                                  Salesforce Data Actions:
                                    dataAction:
                                      Get Contact By Phone Number:
                                        inputs:
                                          PHONE_NUMBER:
                                            exp: "\"Task.CustomerInput\""
                                        successOutputs:
                                          Id:
                                            noValue: true
                                          FirstName:
                                            var: Task.CustomerFirstName
                                          LastName:
                                            noValue: true
                                          Phone:
                                            noValue: true
                                          HomePhone:
                                            noValue: true
                                          MobilePhone:
                                            noValue: true
                                          OtherPhone:
                                            noValue: true
                                          Email:
                                            var: Task.CustomerEmail
                                          MailingStreet:
                                            noValue: true
                                          MailingCity:
                                            noValue: true
                                          MailingState:
                                            noValue: true
                                          MailingPostalCode:
                                            noValue: true
                                          MailingCountry:
                                            noValue: true
                                outputs:
                                  success:
                                    actions:
                                      - setScreenPop:
                                          name: Set Screen Pop
                                          screenPopScript:
                                            Salesforcw Script:
                                              inputs:
                                                Customer Input:
                                                  exp: Task.CustomerInput
                                                First Name:
                                                  exp: Task.CustomerFirstName
                                                Customer Email:
                                                  exp: Task.CustomerEmail
                                      - transferToAcd:
                                          name: Transfer to ACD
                                          targetQueue:
                                            lit:
                                              name: Customer Support
                                          preTransferAudio:
                                            tts: Wait for next available agent
                                          failureTransferAudio:
                                            tts: Sorry call again later
                                          priority:
                                            lit: 5
                                          preferredAgents:
                                            noValue: true
                                          languageSkill:
                                            noValue: true
                                          failureOutputs:
                                            errorType:
                                              noValue: true
                                            errorMessage:
                                              noValue: true
                                          outputs:
                                            failure:
                                              actions:
                                                - playAudio:
                                                    name: Play Audio
                                                    audio:
                                                      tts: Sorry, call again later.
                                                - disconnect:
                                                    name: Disconnect
                                  failure:
                                    actions:
                                      - playAudio:
                                          name: Play Audio
                                          audio:
                                            tts: Sorry, call back
                                      - disconnect:
                                          name: Disconnect
                                  timeout:
                                    actions:
                                      - jumpToMenu:
                                          name: Jump to Menu
                                          targetMenuRef: "/inboundCall/menus/menu[Main Menu_10]"
                        failure:
                          actions:
                            - playAudio:
                                name: Play Audio
                                audio:
                                  tts: Sorry, please call back later
                            - disconnect:
                                name: Disconnect
